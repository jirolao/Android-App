{"version":3,"file":"GLViewNative.js","names":["GLViewNative","Component","ref","gl","getExtension","name","call","props","onContextCreate","opt","Promise","reject","Error","takeSnapshotAsync","afterDraw","flush","endFrameEXP","render","style","children","rest","__DEV__","console","warn","position","overflow","flex","top","left","onRef","opacity"],"sources":["../src/GLViewNative.js"],"sourcesContent":["//@flow\nimport React, { Component } from \"react\";\nimport { View } from \"react-native\";\nimport { GLView as EXGLView } from \"expo-gl\";\n\nexport default class GLViewNative extends Component<{\n  onContextCreate: (gl: WebGLRenderingContext) => void,\n  style?: any,\n  children?: any,\n}> {\n  afterDraw(gl: WebGLRenderingContext) {\n    gl.flush();\n    // $FlowFixMe\n    gl.endFrameEXP();\n  }\n\n  ref: ?EXGLView;\n  onRef = (ref: ?EXGLView) => {\n    this.ref = ref;\n  };\n\n  onContextCreate = (gl: WebGLRenderingContext) => {\n    const { getExtension } = gl;\n    // monkey patch to get a way to access the EXGLView\n    // $FlowFixMe\n    gl.getExtension = (name) => {\n      if (name === \"GLViewRef\") return this.ref;\n      return getExtension.call(gl, name);\n    };\n    this.props.onContextCreate(gl);\n  };\n\n  capture = (\n    opt: *\n  ): Promise<{\n    uri: string,\n    localUri: string,\n    width: number,\n    height: number,\n  }> => {\n    const { ref } = this;\n    if (!ref) return Promise.reject(new Error(\"glView is unmounted\"));\n    return ref.takeSnapshotAsync(opt);\n  };\n\n  render() {\n    const { style, onContextCreate, children, ...rest } = this.props;\n    if (__DEV__) {\n      if (\"width\" in rest || \"height\" in rest) {\n        console.warn(\n          \"gl-react-expo <Surface>: no such width/height prop. instead you must use the style prop like for a <View>.\"\n        );\n      }\n    }\n    return (\n      <View\n        {...rest}\n        style={[{ position: \"relative\", overflow: \"hidden\" }, style]}\n      >\n        <EXGLView\n          style={[\n            style,\n            {\n              flex: 1,\n              position: \"absolute\",\n              top: 0,\n              left: 0,\n            },\n          ]}\n          onContextCreate={this.onContextCreate}\n          ref={this.onRef}\n        />\n        <View style={{ opacity: 0 }}>{children}</View>\n      </View>\n    );\n  }\n}\n"],"mappings":";;;;;;;AACA;;AACA;;AACA;;;;;;;;;;;;;;;;AAEe,MAAMA,YAAN,SAA2BC,gBAA3B,CAIZ;EAAA;IAAA;;IAAA;;IAAA,+BAQQC,GAAD,IAAoB;MAC1B,KAAKA,GAAL,GAAWA,GAAX;IACD,CAVA;;IAAA,yCAYkBC,EAAD,IAA+B;MAC/C,MAAM;QAAEC;MAAF,IAAmBD,EAAzB,CAD+C,CAE/C;MACA;;MACAA,EAAE,CAACC,YAAH,GAAmBC,IAAD,IAAU;QAC1B,IAAIA,IAAI,KAAK,WAAb,EAA0B,OAAO,KAAKH,GAAZ;QAC1B,OAAOE,YAAY,CAACE,IAAb,CAAkBH,EAAlB,EAAsBE,IAAtB,CAAP;MACD,CAHD;;MAIA,KAAKE,KAAL,CAAWC,eAAX,CAA2BL,EAA3B;IACD,CArBA;;IAAA,iCAwBCM,GADQ,IAOJ;MACJ,MAAM;QAAEP;MAAF,IAAU,IAAhB;MACA,IAAI,CAACA,GAAL,EAAU,OAAOQ,OAAO,CAACC,MAAR,CAAe,IAAIC,KAAJ,CAAU,qBAAV,CAAf,CAAP;MACV,OAAOV,GAAG,CAACW,iBAAJ,CAAsBJ,GAAtB,CAAP;IACD,CAlCA;EAAA;;EACDK,SAAS,CAACX,EAAD,EAA4B;IACnCA,EAAE,CAACY,KAAH,GADmC,CAEnC;;IACAZ,EAAE,CAACa,WAAH;EACD;;EA+BDC,MAAM,GAAG;IACP,oBAAsD,KAAKV,KAA3D;IAAA,MAAM;MAAEW,KAAF;MAASV,eAAT;MAA0BW;IAA1B,CAAN;IAAA,MAA6CC,IAA7C;;IACA,IAAIC,OAAJ,EAAa;MACX,IAAI,WAAWD,IAAX,IAAmB,YAAYA,IAAnC,EAAyC;QACvCE,OAAO,CAACC,IAAR,CACE,4GADF;MAGD;IACF;;IACD,oBACE,6BAAC,iBAAD,eACMH,IADN;MAEE,KAAK,EAAE,CAAC;QAAEI,QAAQ,EAAE,UAAZ;QAAwBC,QAAQ,EAAE;MAAlC,CAAD,EAA+CP,KAA/C;IAFT,iBAIE,6BAAC,cAAD;MACE,KAAK,EAAE,CACLA,KADK,EAEL;QACEQ,IAAI,EAAE,CADR;QAEEF,QAAQ,EAAE,UAFZ;QAGEG,GAAG,EAAE,CAHP;QAIEC,IAAI,EAAE;MAJR,CAFK,CADT;MAUE,eAAe,EAAE,KAAKpB,eAVxB;MAWE,GAAG,EAAE,KAAKqB;IAXZ,EAJF,eAiBE,6BAAC,iBAAD;MAAM,KAAK,EAAE;QAAEC,OAAO,EAAE;MAAX;IAAb,GAA8BX,QAA9B,CAjBF,CADF;EAqBD;;AAlEA"}